---
output: pdf_document
classoption: landscape
---

```{r, echo=FALSE, message=FALSE, cache=FALSE, results='hide', warning=FALSE, fig.height=14, fig.width=27,fig.cap= "**Figure 3.** Fitted posterior estimates of the presence-absence of interaction (a, b and c) and number of visits (d, e and f) of the different pollinator guilds in relation to the main axes of plant reproductive trait variation (PC1, PC2 and PC3). PC1 represents the flower number - flower size axis, PC2 represents the autonomous selfing - floral display axis and PC3 represents the style length - autonomous selfing axis. For visualization purposes due to large differences between number of visits from bees and the rest of the pollinator guilds, the number of visits was log-transformed (Y-axis of lower panel)."}

#LOAD LIBRARIES 
#library(phytools)
#library(ape) #for phylogenetic distance
#library(dplyr) #data processing
#library(rtrees) #for phylogenetic distancelibrary(MASS)
#library(reshape2)
library(viridis) #COLOUR GGPLOT
#library(MASS)
library(ggplot2)
library(broman) #crayon colours
#library(tidyverse)
library(patchwork) #panel of plots
#library(brms)
#library(cmdstanr)

#Load theme for publication

theme_ms <- function(base_size=14, base_family="Helvetica") {
  (theme_bw(base_size = base_size, base_family = base_family)+
     theme(text=element_text(color="black"),
           axis.title=element_text( size = rel(2)),
           axis.text=element_text(size = rel(1.8), color = "black"),
           legend.title=element_text(face="bold",size=rel(2)),
           legend.text=element_text(size=rel(1.4)),
           legend.background=element_rect(fill="transparent"),
           legend.key.size = unit(2, 'lines'),
           panel.border=element_rect(color="black",size=2.4),
           panel.grid.minor.x =element_blank(),
           panel.grid.minor.y= element_blank(),
           panel.grid.major= element_blank(),
           plot.title = element_text(hjust = 0.5,size=rel(2.75),face="bold"),
           plot.subtitle = element_text(face="bold",size=rel(2))
     ))
}


p1 <- readRDS("../Main_Figures/figure_3_1.rds")
p2 <- readRDS("../Main_Figures/figure_3_2.rds")
p3 <- readRDS("../Main_Figures/figure_3_3.rds")
pp1 <- readRDS("../Main_Figures/figure_3_4.rds")
pp2 <- readRDS("../Main_Figures/figure_3_5.rds")
pp3 <- readRDS("../Main_Figures/figure_3_6.rds")

library(patchwork)

combined <- pp1 + pp2 + pp3 + p1 + p2 + p3  & theme(legend.position = "bottom") &  guides(color = guide_legend(override.aes = list(size=6.5), keywidth=1.8, keyheight=0.1,default.unit="inch"))

combined + plot_layout(guides = "collect",ncol = 3)
```
