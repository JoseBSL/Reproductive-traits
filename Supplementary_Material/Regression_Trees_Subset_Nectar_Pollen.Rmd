---
title: ""
output:
  pdf_document: default
  html_document: default
classoption: landscape

---


```{r, echo=FALSE, message=FALSE, cache=FALSE, results='hide', warning=FALSE, fig.height=4.25, fig.width=17.5}

########################################################################################################################################################
#SCRIPT TO CALCULATE THE REGRESSION TREE OF NECTAR AND PLOT IT
########################################################################################################################################################
#READ NETWORK VISITATION DATA (VISITS AGGREGATED PER PLANT SPECIES)

library(rpart.plot)
library(rpart)

setwd("~/R_Projects/Reproductive Traits")

v_df <- readRDS("Data/RData/log_visits_subset_nectar_pollen_tree.rds")
nd_df <-  readRDS("Data/RData/normalized_degree_subset_nectar_pollen_tree.rds")
d_df <- readRDS("Data/RData/specialization_subset_nectar_pollen_tree.rds")

#Set correct colnames for plotting
colnames(v_df) <- c("Visits", "Aut. selfing", "Flowers per plant", "Flower width", "Style length (mm)",
                      "Ovule number","Plant height (m)",  "Microlitres of nectar",  "Nectar concentration (%)","Pollen grains per flower")

colnames(nd_df) <- c("Normalized degree", "Aut. selfing", "Flowers per plant", "Flower width", "Style length (mm)",
                      "Ovule number","Plant height",  "Microlitres of nectar",  "Nectar concentration (%)","Pollen grains per flower")

colnames(d_df) <- c("Specialization", "Aut. selfing", "Flowers per plant", "Flower width", "Style length (mm)",
                      "Ovule number","Plant height (m)",  "Microlitres of nectar",  "Nectar concentration (%)","Pollen grains per flower")



set.seed(2)
tree1 <- rpart(Visits~., data=v_df, cp=0.0154001) 

set.seed(2)
tree2 <- rpart(`Normalized degree`~., data=nd_df, cp=0.0125459) 

set.seed(2)
tree3 <- rpart(Specialization~., data=d_df, cp=0.0190352) 
par(mfrow=c(1,3))


rpart.plot(tree1, box.palette="GnOr", main="(a) Interaction frequency", cex.main=1.5,tweak = 1.25,type = 2) 
rpart.plot(tree2, box.palette="GnOr", main="(b) Normalized degree", cex.main=1.5,tweak = 1.25,type = 2)
rpart.plot(tree3, box.palette="GnOr", main="(c) Specialization", cex.main=1.5,tweak = 1.15,type = 2)


```