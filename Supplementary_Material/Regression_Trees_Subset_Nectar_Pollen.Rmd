---
title: ""
output:
  pdf_document: default
  html_document: default
classoption: landscape

---

\pagenumbering{gobble}


```{r, echo=FALSE, message=FALSE, cache=FALSE, results='hide', warning=FALSE, fig.height=4.3, fig.width=15, out.width="105%"}

########################################################################################################################################################
#SCRIPT TO CALCULATE THE REGRESSION TREE OF NECTAR AND PLOT IT
########################################################################################################################################################
#READ NETWORK VISITATION DATA (VISITS AGGREGATED PER PLANT SPECIES)

library(rpart.plot)
library(rpart)

setwd("~/R_Projects/Reproductive Traits")

v_df <- readRDS("Data/RData/log_visits_subset_nectar_pollen_tree.rds")
nd_df <-  readRDS("Data/RData/normalized_degree_subset_nectar_pollen_tree.rds")
d_df <- readRDS("Data/RData/specialization_subset_nectar_pollen_tree.rds")

#Set correct colnames for plotting
colnames(v_df) <- c("Visits", "Aut. selfing", "Flowers per plant", "Flower width", "Style length (mm)",
                      "Ovule number","Plant height (m)",  "Microlitres of nectar",  "Nectar concentration (%)","Pollen g. per flower")

colnames(nd_df) <- c("Normalized degree", "Aut. selfing", "Flowers per plant", "Flower width", "Style length (mm)",
                      "Ovule number","Plant height (m)",  "Microlitres of nectar",  "Nectar concentration (%)","Pollen g. per flower")

colnames(d_df) <- c("Specialization", "Aut. selfing", "Flowers per plant", "Flower width", "Style length (mm)",
                      "Ovule number","Plant height (m)",  "Microlitres of nectar",  "Nectar concentration (%)","Pollen g. per flower")



set.seed(2)
tree1 <- rpart(Visits~., data=v_df,  cp=0.009000,minbucket=50) 

set.seed(2)
tree2 <- rpart(`Normalized degree`~., data=nd_df, cp=0.005000,minbucket=50) 

set.seed(2)
tree3 <- rpart(Specialization~., data=d_df, cp=0.0050000,minbucket=50) 
par(mfrow=c(1,3))


rpart.plot(tree1, box.palette="GnOr", main="A Interaction frequency", cex.main=2.25,tweak = 1.50,type = 2) 
rpart.plot(tree2, box.palette="GnOr", main="B Normalized degree", cex.main=2.25,tweak = 1.50,type = 2)
rpart.plot(tree3, box.palette="GnOr", main="C Specialization", cex.main=2.25,tweak = 1.50,type = 2)

```