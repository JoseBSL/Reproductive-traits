---
title: "Untitled"
output:
  pdf_document: default
  html_document: default
---

```{r, echo=FALSE, message=FALSE, cache=FALSE, results='hide', warning=FALSE, fig.cap="**Figure S1.** Map with the different locations of the plant-pollinator studies used in this work to explore woldwide patterns at the meso-scale level. For each study just one location is shown except for the study of Olesen that was conducted in two very different locations (Mauritius and Azores)."}


#Create coordinate dataset for plotting

longitude <- c("3.296797",  #1
               "1.575532", #2
               "9.275556", 
               "18.5", #4
               "99.63806", #5
               "148.266667",
               "-52", 
               "-31", "57.43", #8
               "-75.5", #9
               "-57.885", #10
               "55.447778",
               "-6.16895", #12bart
               "55.43333", #13
               "57.733333",
               "-68.015892", #15
               "-89.8968771",
               "171.756111",
               "10.233333",
               "-90.35",
               "-93.8968771",#Robertson
               "-67.4292900",
               "-61.71666666666667",
               "175.756111",
               "-71.3",
               "129.387359", #Kevan
               "135.75385",
               "-93.35",
               "10.219072")  

latitude <- c("42.315336", #1
              "52.762395", #2
              "56.0725",
              "68.35", #4
              "27.90139", #5
              "-36.45", #6
              "71", #7
              "39.4", "-23.25", #8 #modified for visibility of ovelapping
              "45.4", #9
              "-21.701111", #10
              "-7.67",#11 #modified for visibility of ovelapping
              "37.234966", #12bart
              "-4.666667", #13
              "-20.4538",
              "-32.008985", #15
              "39.278958",
              "-43.035889",
              "59.066667",#18 #modified for visibility of ovelapping
              "-0.533333",
              "39.278958", #Robertson 
              "8.9241600",
              "5.5833333",
              "-43.035889",
              "81.8166667",
              "28.288661", #Kevan 
              "35.02107",
              "-0.533333",
              "56.069108") 

id <- c("Bartomeus1", #1
        "Dicks", #2
        "Dupont", 
        "Elberling", #4
        "Fang", #5
        "Inouye1", #6
        "Lundgren", #7
        "Olesen", "Olesen", #8
        "Small", #9
        "Souza", #10
        "Kaiser-Bunbury1", #
        "Bartomeus2", #12
        "Kaiser-Bunbury2", #13
        "Kaiser-Bunbury3", #14
        "Peralta", #15
        "Burkle",
        "Arroyo-Correa",
        "Bundgaard",
        "Traveset",
        "Robertson",
        "Ramirez1",
        "Ramirez2",
        "Primack",
        "Kevan",
        "Kato",
        "Inouye2",
        "McMullen",
        "Baek")

d <- data.frame(longitude, latitude, id)

library("ggplot2")
library("sf")
library("rnaturalearth")
library("rnaturalearthdata")

world <- ne_countries(scale = "medium", returnclass = "sf")
class(world)

d$longitude <- as.numeric(d$longitude)
d$latitude <- as.numeric(d$latitude)

sf::sf_use_s2(FALSE)

#these colors come from the library(pals)- labs = c('alphabet')


colors <- c("red4", "#0075DC", "#4C005C", "#4C005C", "#993F00",  "#5EF1F2", 
        "#005C31", "#2BCE48", "black", "lightblue", "darkorange3", "darkorange3","#8F7C00",
        "#8F7C00","#8F7C00", "#9DCC00", "#C20088", "gold1","#FFA8BB","#426600","94FFB5","#003380",  
         "#FF0010","#FF0010", "salmon", "seashell3","greenyellow","mediumaquamarine")

set.seed(12)
ggplot(data = world) +
  geom_sf(fill="antiquewhite", color="grey49") +
  xlab("Longitude") + ylab("Latitude") +
  geom_point(data=d , aes(longitude,latitude,  color=id),  shape=10,
           size = 3.5, stroke=1)+ 
  theme(panel.grid.major = element_line(color = gray(.5), 
linetype = "dashed", size = 0), panel.background = element_rect(fill = "aliceblue"))+
  coord_sf(expand = FALSE) +  scale_y_continuous(breaks = c(-50,0, 50)) +
  scale_x_continuous(breaks = c(-100,0, 100)) +
  theme(legend.key.size = unit(0.5, 'cm'), legend.text = element_text(size=6),
         legend.title = element_text(size=12))+
  scale_colour_discrete(name = "Study \n locations") +   scale_colour_manual(
    values = colors)
  



```
